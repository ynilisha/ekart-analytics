INSERT OVERWRITE TABLE runsheet_shipment_fact
SELECT distinct tasklist_id,
tasklist_type, 
lookupkey('facility_id',facility_id),
vehicle_number,
lookupkey('agent_id',primary_agent_id),
secondary_agent_id_1,
secondary_agent_id_2,
secondary_agent_id_3,
secondary_agent_id_4,
secondary_agent_id_5,
lookup_date(tasklist_closed_date_time),
lookup_time(tasklist_closed_date_time),
lookup_date(tasklist_start_date_time),
lookup_time(tasklist_start_date_time),
lookup_date(tasklist_end_date_time),
lookup_time(tasklist_end_date_time),
tasklist_no_of_shipments_attempted,
lookup_date(tasklist_first_action_date_time),
lookup_time(tasklist_first_action_date_time),
lookup_date(tasklist_last_action_date_time),
lookup_time(tasklist_last_action_date_time),
lookupkey('device_id',tasklist_pos_id), 
lookupkey('device_id',tasklist_smart_device_id),
agent_and_date,
vehicle_and_date,
vehicle_type,
lookup_date(tasklist_created_date_time),
lookup_time(tasklist_created_date_time),
vendor_tracking_id,
shipment_actioned_flag,
lookup_date(shipment_delivered_datetime_from_runsheet),
lookup_time(shipment_delivered_datetime_from_runsheet),
shipment_type,
shipment_priority_flag,
lookup_date(shipment_delivered_at_datetime),
lookup_time(shipment_delivered_at_datetime),
lookup_date(shipment_first_delivery_update_datetime),
lookup_time(shipment_first_delivery_update_datetime),
lookup_date(shipment_last_delivery_update_datetime),
lookup_time(shipment_last_delivery_update_datetime),
payment_type,
payment_mode,
undelivered_status,
seller_type,
address_full,
address_hash,
latitude,
longitude,
device_id,
type,
ekl_fin_zone,
shipment_weight,
attempt_no,
geo_city,
geo_state,
geo_accuracy_level,
seller_id_key,
customer_pincode_key,
shipment_carrier,
service_tier,
shipment_value,
customer_promise_date_key,
customer_promise_time_key,
logistics_promise_date_key,
logistics_promise_time_key,
new_customer_promise_date_key,
new_customer_promise_time_key,
fsd_first_dh_received_date_key,
fsd_first_dh_received_time_key,
customer_address_id_key,
shipping_category,
billable_weight,
order_item_date_key,
order_item_time_key,
shipment_flash_flag,
analytic_super_category,
call_per_attempt,
leg1duration,
leg2duration,
shipment_item_unit_dispatch_service_tier,
attempt_type,
adm_flag,
core_fsn_flag,
shipment_lzn_classification,
lookup_date(device_update_time),
lookup_time(device_update_time),
deviceid,
shipment_value_bucket,
primary_product_key
from bigfoot_external_neo.scp_ekl__runsheet_shipment_map_l1_fact;